name: Build FCL APK with Wildcard (Manual)

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    # 1. 检出你的代码库
    - name: Checkout repository
      uses: actions/checkout@v4

    # 2. 设置 JDK 17 环境
    - name: Set up JDK 17
      uses: actions/setup-java@v4
      with:
        java-version: '17'
        distribution: 'zulu'
        cache: gradle

    # 3. 设置 Android SDK
    - name: Setup Android SDK
      uses: android-actions/setup-android@v3

    # 4. 安装指定的 NDK 版本
    - name: Set up NDK 27.0.12077973
      run: |
        echo "y" | sudo ${ANDROID_HOME}/tools/bin/sdkmanager --install "ndk;27.0.12077973" --sdk_root=${ANDROID_HOME}
    
    # 5. 授予 gradlew 执行权限
    - name: Grant execute permission for gradlew
      run: chmod +x gradlew

    # 6. 使用 Gradle 构建项目
    # 你可以运行 'assembleDebug' 或 'assembleRelease'
    # 或者 'assemble' 来构建所有变体
    - name: Build with Gradle
      run: ./gradlew :FCL:assembleDebug

    # 7. 使用通配符上传构建生成的 APK
    - name: Upload APK artifact
      uses: actions/upload-artifact@v4
      with:
        name: fcl-apk
        path: FCL/build/outputs/apk/**/*.apk